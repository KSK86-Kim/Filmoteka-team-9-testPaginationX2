(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{OSpC:function(e,t,n){},QfWi:function(e,t,n){"use strict";n.r(t);n("lmye"),n("fp7Y"),n("OSpC");var a={searchInput:document.querySelector(".search-input"),moviesCardsGallery:document.querySelector(".movie__list"),movieInfoModal:document.querySelector(".modal-movie"),loadWatchedBtn:document.querySelector("[data-modal-watched]"),loadQueueBtn:document.querySelector("[data-modal-queue]"),addWatchedBtn:document.querySelector("[data-add-watched]"),addQueueBtn:document.querySelector("[data-add-queue]"),btnNextPagination:document.querySelector("#next-pagination"),btnPrevPagination:document.querySelector("#prev-pagination"),paginationControls:document.querySelector(".pagination-controls__list")},o=(n("/YXa"),n("JBxO"),n("FdtR"),n("WoWj"),n("qoNQ"),n("U00V"),n("h8BN")),r=n.n(o);n("xhcB");function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){var n=t.get(e);if(!n)throw new TypeError("attempted to get private field on non-instance");return n.get?n.get.call(e):n.value}var c="e25e680121e89083bb4ba7c0772c65fc",u=new WeakMap,s=function(){function e(e){u.set(this,{writable:!0,value:2}),this.page=1,this.totalPagas=0,this.movies=[],this.searchQuery="",this.watched=[],this.queue=[],this._watchedFromLocalStorage=[],this._queueFromLocalStorage=[],this.selectControl=e}var t,n,o,s=e.prototype;return s.fetchMovieByID=function(e){return fetch("https://api.themoviedb.org/3/movie/"+e+"?api_key="+c).then((function(e){if("404"===e.status)throw new Error;e.json()}))},s.movieAdapter=function(e){var t=e.poster_path,n=e.original_title,a=e.original_name,o=e.vote_average,r=e.release_date,i=e.first_air_date;return{imgSrc:this.generatePosterPath(t),title:n||a,rating:o,releaseDate:r||i}},s.generatePosterPath=function(e){return"https://themoviedb.org/t/p/w220_and_h330_face"+e},s.fetchSearchMoviesList=function(e){var t=this;return fetch("https://api.themoviedb.org/3/search/movie?api_key="+c+"&query="+e+"&page="+this.page).then((function(e){return e.json()})).then((function(e){return t.totalPagas=e.total_pages,console.log(e),console.log(t.totalPagas),e}))},s.fetchPopularMoviesList=function(){var e=this;return fetch("https://api.themoviedb.org/3/trending/all/day?api_key="+c+"&page="+this.page).then((function(e){return e.json()})).then((function(t){return e.totalPagas=t.total_pages,console.log(t),console.log(e.totalPagas),t}))},s.pagination=function(e,t){var n=this.addButtonWithIndex(1);e-l(this,u)>2&&(n+=this.addButtonInput());for(var a=e-l(this,u);a<=e+l(this,u);a++)a>1&&a<t&&(n+=this.addButtonWithIndex(a));e+l(this,u)<t-1&&(n+=this.addButtonInput()),n+=this.addButtonWithIndex(t),this.selectControl.innerHTML=n},s.addButtonWithIndex=function(e){return' <li class="pagination-controls__item"><button id=\'pagination_'+e+"' class='pagination-controls__btn' type='button'>"+e+"</button></li>"},s.addButtonInput=function(){return' <li class="pagination-controls__item"><input class="pagination-controls__input" type="number" placeholder="..." /></li>'},s.fetchWatchedMoviesList=function(){},s.fetchQueueMoviesList=function(){},s.fetchModalMovie=function(){},s.loadWatchedMovies=function(){var e=localStorage.getItem("watched");this._watchedFromLocalStorage=JSON.parse(e)},s.loadQueueMovies=function(){var e=localStorage.getItem("queue");this._queueFromLocalStorage=JSON.parse(e)},s.addWatchedMovies=function(e){},s.addQueueMovies=function(e){this.queue.push(e),localStorage.setItem("queue",JSON.stringify(this.queue))},s.renderMovieCards=function(e){a.moviesCardsGallery.insertAdjacentHTML("beforeend",r()(e))},s.renderMovie=function(e){},s.incrementPage=function(){this.page+=1},s.resetPage=function(){this.page=1},s.goToPrevPage=function(){1!==this.page&&(this.page-=1)},s.goToNextPage=function(){this.page!==this.totalPagas+1&&(this.page+=1)},t=e,(n=[{key:"watchedFromLocalStorage",get:function(){return this._watchedFromLocalStorage}},{key:"queueFromLocalStorage",get:function(){return this._queueFromLocalStorage}}])&&i(t.prototype,n),o&&i(t,o),e}(),h=(n("zrP5"),n("QJ3N").error),d=n("QJ3N").defaults;function p(){return h({text:"Please enter CORRECT query"})}d.closer=!1,d.sticker=!1,d.delay=2e3,d.shadow=!0;var g=n("jffb"),f=new s(a.paginationControls);function m(){P(),f.resetPage(),f.fetchPopularMoviesList().then((function(e){return b(e)})),f.pagination(f.page,f.totalPagas)}function v(){P(),f.fetchPopularMoviesList().then((function(e){return b(e)})),f.pagination(f.page,f.totalPagas)}function y(e){if(e.preventDefault(),P(),f.resetPage(),f.searchQuery=e.target.value,console.log("Api.searchQuery:",f.searchQuery),!f.searchQuery)return m();f.fetchSearchMoviesList(f.searchQuery).then((function(e){if(b(e),f.pagination(f.page,f.totalPagas),!e.total_results)return p()}))}function _(){P(),f.searchQuery=a.searchInput.value,console.log("Api.searchQuery:",f.searchQuery),f.fetchSearchMoviesList(f.searchQuery).then((function(e){if(b(e),f.pagination(f.page,f.totalPagas),!e.total_results)return p()}))}function P(){a.moviesCardsGallery.innerHTML=""}function b(e){console.log(e.results);var t=e.results.map((function(e){return f.movieAdapter(e)}));return f.renderMovieCards(t)}function L(){P(),f.resetPage(),a.loadWatchedBtn.classList.add("active-btn"),a.loadQueueBtn.classList.remove("active-btn"),console.log("отрисовать просмотренные фильмы"),f.fetchWatchedMoviesList().then((function(e){return b(e)}))}function S(){P(),f.resetPage(),a.loadWatchedBtn.classList.remove("active-btn"),a.loadQueueBtn.classList.add("active-btn"),console.log("отрисовать фильмы добавленные в очередь пользователя"),f.fetchQueueMoviesList().then((function(e){return b(e)}))}function w(e){e<1||e>=f.totalPagas||(f.page=e,v())}function Q(e){e<1||e>=f.totalPagas||(f.page=e,_())}window.addEventListener("load",(function(){var e=document.getElementsByTagName("html")[0];e.classList.contains("main-page")&&(m(),a.searchInput.addEventListener("input",g(y,500)));e.classList.contains("library-page")&&(a.loadWatchedBtn.addEventListener("click",L),a.loadQueueBtn.addEventListener("click",S),L())})),a.btnPrevPagination.addEventListener("click",(function(){if(f.goToPrevPage(),!f.searchQuery)return v();_()})),a.btnNextPagination.addEventListener("click",(function(){if(f.goToNextPage(),!f.searchQuery)return v();_(),console.log(f.page)})),a.paginationControls.addEventListener("click",(function(e){if("BUTTON"===e.target.nodeName){var t=Number(e.target.textContent);if(!f.searchQuery)return w(t);Q(t),console.log(f.page)}if("INPUT"===e.target.nodeName){var n=Number(e.target.value);if(!f.searchQuery)return w(n);Q(n),console.log(f.page)}}))},h8BN:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var r,i=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,c=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="movie__list-item">\r\n    <div class="movie-card__wrapper-img">\r\n        <img class="movie-card__img" src='+c("function"==typeof(r=null!=(r=u(n,"imgSrc")||(null!=t?u(t,"imgSrc"):t))?r:l)?r.call(i,{name:"imgSrc",hash:{},data:o,loc:{start:{line:6,column:41},end:{line:6,column:51}}}):r)+" alt=''>\r\n    </div>\r\n    <h3 class=\"movie-card__name\">"+c("function"==typeof(r=null!=(r=u(n,"title")||(null!=t?u(t,"title"):t))?r:l)?r.call(i,{name:"title",hash:{},data:o,loc:{start:{line:8,column:33},end:{line:8,column:42}}}):r)+'</h3>\r\n    <p class="movie-card__description">'+c("function"==typeof(r=null!=(r=u(n,"releaseDate")||(null!=t?u(t,"releaseDate"):t))?r:l)?r.call(i,{name:"releaseDate",hash:{},data:o,loc:{start:{line:9,column:39},end:{line:9,column:54}}}):r)+'</p>\r\n    <p class="movie-card__rating">'+c("function"==typeof(r=null!=(r=u(n,"rating")||(null!=t?u(t,"rating"):t))?r:l)?r.call(i,{name:"rating",hash:{},data:o,loc:{start:{line:10,column:34},end:{line:10,column:44}}}):r)+"</p>\r\n</li>\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var r;return"\r\n"+(null!=(r=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:3,column:0},end:{line:12,column:9}}}))?r:"")},useData:!0})},xhcB:function(e,t,n){var a=n("mp5j");e.exports=(a.default||a).template({1:function(e,t,n,a,o){var r,i=null!=t?t:e.nullContext||{},l=e.hooks.helperMissing,c=e.escapeExpression,u=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<li class="pagination-controls__item">\r\n    <button id=\'pagination_'+c("function"==typeof(r=null!=(r=u(n,"key")||(null!=t?u(t,"key"):t))?r:l)?r.call(i,{name:"key",hash:{},data:o,loc:{start:{line:3,column:27},end:{line:3,column:34}}}):r)+"' type='input' class=\"pagination-controls__btn\">"+c("function"==typeof(r=null!=(r=u(n,"key")||(null!=t?u(t,"key"):t))?r:l)?r.call(i,{name:"key",hash:{},data:o,loc:{start:{line:3,column:82},end:{line:3,column:89}}}):r)+"</button>\r\n</li>\r\n"},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,o){var r;return null!=(r=(e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]})(n,"each").call(null!=t?t:e.nullContext||{},t,{name:"each",hash:{},fn:e.program(1,o,0),inverse:e.noop,data:o,loc:{start:{line:1,column:0},end:{line:5,column:9}}}))?r:""},useData:!0})}},[["QfWi",1,2]]]);
//# sourceMappingURL=main.9a5ded4289c2bd1d7dfc.js.map